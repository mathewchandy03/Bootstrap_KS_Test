\documentclass[12pt, letterpaper]{article}
%\documentclass[12pt, letterpaper, titlepage]{article}

\usepackage{amsmath}
\usepackage{booktabs}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{colorlinks = true, linkcolor = blue, citecolor=blue, urlcolor = blue}
\usepackage{natbib}
\usepackage{enumitem}
\usepackage{setspace}

\usepackage[]{lineno}
\linenumbers*[1]
% %% patches to make lineno work better with amsmath
\newcommand*\patchAmsMathEnvironmentForLineno[1]{%
 \expandafter\let\csname old#1\expandafter\endcsname\csname #1\endcsname
 \expandafter\let\csname oldend#1\expandafter\endcsname\csname end#1\endcsname
 \renewenvironment{#1}%
 {\linenomath\csname old#1\endcsname}%
 {\csname oldend#1\endcsname\endlinenomath}}%
\newcommand*\patchBothAmsMathEnvironmentsForLineno[1]{%
 \patchAmsMathEnvironmentForLineno{#1}%
 \patchAmsMathEnvironmentForLineno{#1*}}%

\AtBeginDocument{%
 \patchBothAmsMathEnvironmentsForLineno{equation}%
 \patchBothAmsMathEnvironmentsForLineno{align}%
 \patchBothAmsMathEnvironmentsForLineno{flalign}%
 \patchBothAmsMathEnvironmentsForLineno{alignat}%
 \patchBothAmsMathEnvironmentsForLineno{gather}%
 \patchBothAmsMathEnvironmentsForLineno{multline}%
}

% control floats
\renewcommand\floatpagefraction{.9}
\renewcommand\topfraction{.9}
\renewcommand\bottomfraction{.9}
\renewcommand\textfraction{.1}
\setcounter{totalnumber}{50}
\setcounter{topnumber}{50}
\setcounter{bottomnumber}{50}

\newcommand{\jy}[1]{\textcolor{blue}{JY: #1}}
\newcommand{\eds}[1]{\textcolor{red}{EDS: (#1)}}

% NOTE: To produce blinded version, replace "0" with "1" below.
\newcommand{\blind}{0}

\begin{document}
%\maketitle

\if0\blind
{
  \title{\bf Nonparametric Bootstrap KS Test with Stationary Time Series}
  \author{Mathew Chandy, %\\
%   \href{mailto:mathew.chandy@uconn.edu}
% {\nolinkurl{mathew.chandy@uconn.edu}}\\
  Jun Yan, %\\
  Xianyang Zhang\\
}
\date{}
  \maketitle
} \fi

\if1\blind
{
  \bigskip
  \bigskip
  \bigskip
  \begin{center}
    {\LARGE\bf Nonparametric Bootstrap KS Test with Stationary Time Series}
\end{center}
  \bigskip
} \fi


\doublespace

\begin{abstract}

The Kolmogorov-Smirnov (KS) statistic is widely used to test if a sample is
from a given distribution.


\bigskip
\noindent{\sc Keywords}:
\end{abstract}

%\doublespace

\jy{double blank liines to better separate paragraphs}

\section{Introduction}
\label{sec:intro}

The Kolmogorov-Smirnov (KS) test is a useful goodness-of-fit statistic. It 
can be used to see if a population follows a hypothesized distribution and has 
and can be applied to a variety of fields. It has
been used to analyze the random distribution of cosmic microwave background 
radiation \citep{naess2012application}. A common misuse of the KS test is when
the hypothesized distribution has unspecified parameters. 
\citet{babu2004goodness} approaches this scenario using basic 
non-parametric bootstrap. There is also the scenario where both the hypothesized 
distribution has unspecified parameters and additionally the data are 
serially dependent. \citet{zeimbekakis2022misuses} demonstrates a remedy for
this scenario using semi-parametric bootstrap. This study aims to address this
scenario with non-parametric block bootstrap.

The rest of the paper is outlined as follows: in the first 
section, we assess whether the KS
test holds its size; that is, does the test fail to reject the null hypothesis
when it is true. In the second section, we evaluate the 
test's power; that is, does the test reject the null hypothesis when it is 
false.
Finally, we end with 
concluding remarks in the third section.

\section{Methods}
\label{sec:methods}

Consider a stationary time series $\{X_t: t = 1, \ldots, n\}$ with length~$n$.
\jy{state the null hypothesis explicitly; we are testing the marginal
  distribution. Point out the challenges.}
Our goal is to see if the data generating model of the series matches a 
hypothesized distribution.


\jy{define $\hat\theta_n$}
If the observations in the series were independent, a 
standard
nonparametric bootstrap KS test would draw a large number~$B$ bootstrap copies 
of the observed data, and compute the empirical distribution and a
fitted distribution from the fitted parameters
$\hat\theta_n^{(b)}$ for each copy $b = 1, \ldots, B$. When serial 
dependence is present, the bootstrap procedure 
needs to preserve the serial dependence. Block bootstrap was motivated for this 
situation.


\jy{No double letter notations}
Consider the goodness of fit statistic:
\begin{equation*}
  T_n := \sup_x|Y_n(x; \hat\theta)|, 
Y_n(x; \hat\theta) = \sqrt{n}(F_n(x) - F(x; \hat\theta_n)),
\end{equation*}
where $F_n$ denotes the empirical distribution function based on $X_1,...,X_n$.
We note that
\begin{equation*}
Y_n(x; \hat\theta) = \sqrt{n}(F_n(x) - F(x)) - 
\sqrt{n}(F(x; \hat\theta_n) - F(x)),
\end{equation*}
where $F(x)$ is the true cdf (under the null $F(x) = F(x, \theta_0)$ for some
true parameter $\theta_0$).


Let us first consider the case where $X_i$'s are i.i.d. Denote by $F^*_n$ the
empirical distribution of the bootstrap sample $X^*_1,...,X^*_n$ and let
$\hat\theta^*_n$ be the parameter estimate based on the bootstrap samples. 
Using the bootstrap (asymptotic) theory, we can approximate the distribution of
\jy{no need for so many in-display equations}
\[
\sqrt{n}(F_n(x) - F(x))
\]
by that of
\[
\sqrt{n}(F^*_n(x) - F_n(x))
\]
and the distribution of
\[
\sqrt{n}(F(x; \hat\theta_n) - F(x))
\]
by that of
\[
\sqrt{n}(F(x; \hat\theta^*_n) - F(x; \hat\theta_n)).
\]
Therefore, if we define
\begin{equation*}
Y^*_n(x) = \sqrt{n}(F^*_n(x) - F_n(x)) - 
\sqrt{n}(F(x; \hat\theta^*_n) - F(x; \hat\theta_n)) 
= \sqrt{n}(F^*_n(x) - F(x; \hat\theta^*_n)) - 
\sqrt{n}(F_n(x) - F(x; \hat\theta_n)),
\end{equation*}
then $KS^*_n := \sup_x|Y^*_n(x)|$ is the bootstrap statistic that is expected
to approximate the distribution of $KS_n$. We note that the term
$\sqrt{n}(F_n(x) - F(x; \hat\theta_n))$ is exactly the bias term considered in 
Babu and Rao (2004).


We now consider the case where $X_i$'s are realizations from a time series and
$X^*_1,...,X^*_n$ are generated by block bootstrap. In this case, we can 
approximate the distribution of
\jy{No need for in-display}
\[
\sqrt{n}(F_n(x) - F(x))
\]
by that of
\[
\sqrt{n}(F^*_n(x) - E^*[F^*_n(x)])
\]
\jy{change the languages to add variety}
and the distribution of
\[
\sqrt{n}(F(x; \theta_n) - F(x))
\]
by that of
\[
\sqrt{n}(F(x; \hat\theta^*_n) - F(x; E^*[\hat\theta^*_n])).
\]
\jy{no closing a sentence before all the notations are introduced}
Here $E^*$ denotes the expectation with respect to the bootstrap distribution
(i.e., the randomness due to the resampling using block botostrap) conditional
on the observations $X_1,...,X_n$. We can compute $E^*[F^*_n(x)]$ and 
$E^*[\hat\theta^*_n]$ numerically (they can also be computed analytically, 
depending on the types of block bootstrap we use). For example, let 
$X^*_{1,b},...,X^*_{n,b}$ be the $b$th block bootstrap sample for 
$1 \leq b \leq B$. One can compute $F^*_{n,b}$ and $\hat\theta^*_{n,b}$ based on
$X^*_{1,b},...,X^*_{n,b}$. Then
\begin{align*}
E^*[F^*_n(x)] &\approx \frac{1}{B}\sum_{b = 1}^BF^*_{n, b}(x),\\
E^*[\hat\theta^*_n] &\approx \frac{1}{B}\sum_{b = 1}^B\hat\theta^*_{n,b}.
\end{align*}
In this case, we can define
\jy{too long}
\begin{equation*}
Y^*_n(x) = \sqrt{n}(F^*_n(x) - E^*[F^*_n(x)]) - 
\sqrt{n}(F(x; \hat\theta^*_n) - F(x; E^*[\hat\theta^*_n)]) 
= \sqrt{n}(F^*_n(x) - F(x; \hat\theta^*_n)) - 
\sqrt{n}(E^*[F^*_n(x)] - F(x; E^*[\hat\theta^*_n])),
\end{equation*}
and $KS^*_n = \sup_x|Y^*_n(x)|$.



\section{Simulation Studies}
\label{sec:simu}

\jy{First size and then power}


\section{Real Data Analysis}

\jy{Find some real time series to test for their marginal distributions. Open
  data, for example, temperatures or stock returns or ...}



\section{Concluding Remarks}
\label{sec:conclusion}





\bibliographystyle{chicago}
\bibliography{citations}


\end{document}
%%% LocalWords: nonparametric semiparametric autocorrelation ARMA
%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% ispell-personal-dictionary: ".aspell.en.pws"
%%% fill-column: 80
%%% eval: (auto-fill-mode 1)
%%% End: